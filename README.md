# 如何使用Git指令以及完成Git操作

> 本文主要介绍的内容包括：
>
> 1. [基本的git操作命令](##基本git操作命令)
>    1. [新建个人账号](###新建个人账号)
> 2. [本地仓库](##本地仓库)
>    1. [初始化仓库](###初始化仓库)
>    2. [文件修改](###文件修改)
>    3. [文件版本回退和回回退](###文件版本回退和回回退)
>       1. [log历史查询](####log历史查询)
>       2. [回退](####回退)
>       3. [回回退](####回回退)
> 3. 远程仓库的git操作指南
> 4. 分支操作
> 5. 团队协作
> 6. 常见错误



## 基本git操作命令

### 新建个人账号



## 本地仓库

### 初始化仓库

进入后面用来写代码的文件夹（图1）

![image-20210722112912573](image-20210722112912573.png)

<center>图1：本地需要建立git仓库的文件夹</center>

执行命令：

```shell
git init # 初始化仓库
```

完成仓库初始化操作

然后去Github创建一个新的仓库

我这里叫做HowToUseGithub，选择仓库属性为公开/私人，然后添加描述，最后确认，得到一个远程托管仓库（图2）

![image-20210722113303059](image-20210722113303059.png)

<center>图2：远程托管仓库完成建立</center>

然后将这个托管仓库的网址（建议选择git打头的ssh地址，比如当前的这个仓库：git@github.com:cuberJ/HowToUseGit.git）复制，进入git界面，执行命令：

```shell
git remote add gitnote git@github.com:cuberJ/HowToUseGit.git
# gitnote是我对这个链接的一个代号，后面每次提交的时候，就可以不用输入网址，而是通过这个代号直接提交给这个仓库
```

添加成功，就可以开始在本地增删改查文件了。



### 文件修改

首先，如果我们新建了一个文件README.md，并在里面写了一些内容，就需要将这些内容先提交到缓冲区：

```shell
git add README.md # 如果文件很多，且所有的文件都需要提交到缓冲区，可以用下面的写法：
git add *
```

提交到缓冲区的文件并没有最终记录，只是为后面的提交做了一个准备。最终正式提交需要执行如下指令：

```shell
# 最简单的提交方式：
git commit -m 'first commit' README.md # 引号内为提交的注释
# 提交还有一种方式：
git commit
# 随后进入一个vim编辑器，在这里可以写一些较长的描述性文档（图3）
# 输入完需要编辑的文档后，按ESC进入命令行模式，然后输入大写的ZZ或者:wq保存退出
# 退出后，git会直接提交所有缓冲区内的文件
```

提交完成后，系统会为该次提交生成一个hash值标签。提交后的记录将会保留在仓库中作为一个log，用于后续倒推版本历史。

![image-20210722153931787](image-20210722153931787.png)

<center>图3：可以生成一个长文档，长文档的第一行文字会作为标题保存在log日志中</center>



### 文件版本回退和回回退

#### log历史查询

文件需要回退至历史版本时，通过hash值确定回退的历史版本

图4中列出了文档目前的所有提交记录。查看提交记录的方式有两种：

```shell
# Windows系统下的git执行操作时，不会出现页面跳转，所以直接输入指令即可；macOS下会出现一次跳转，可以通过管道的方式用cat指令直接展示
git reflog  # reflog模式展示hash值标签的前7位和Head指针，以及简短的commit记录
git reflog | cat # macOS下均采用这种格式在原地展示

# 第二种方式：
git log # 最完整的展示方式
git log --pretty=oneline # 将每次的commit记录放在一行展示，节约展示空间
```

![image-20210722161753317](image-20210722161753317.png)

<center>图4：commit记录展示</center>



#### 回退

需要回退到历史中某个版本时期，可以通过如下指令操作：

```shell
git reset --hard c18c8a9
```

可以回退到hash值为c18c8a9（图4中HEAD{1}的位置）时的文件版本

`--hard`的选项可以替换为`--medium`或者`--soft`，soft不会重置缓冲区，--hard会清空缓冲区



#### 回回退

如果回退后觉得还是新版本的好，还可以重新通过输入hash值返回新版本。回退的操作不会清空commit记录

如果不确定回退几轮，可以通过如下方式操作

```shell
git reset --hard^^^ # hard后面有几个尖角号，就表示回退几个版本
# 如果需要回退的版本很多，还可以这样操作：
git reset --hard~3 # 一样表示回退3个版本
```

回退的本质是修改HEAD指针，HEAD{0}表示最新的修改，移动后HEAD会停留在对应版本的hash值前



## 远程仓库操作指南

之前在[初始化仓库](###初始化仓库)中已经完成了一个Github的仓库创建，现在我们要把数据同步到这个仓库中

执行操作:

```shell
git push gitnote master
```

可以将该仓库推送至该仓库的主分支，即master分支上



## 分支操作

Github关于分支的理念如下：

1. 任务分配的时候，每个分支的人尽量负责独立的文件，尽量不要两个分支上的人同时修改一个文档，否则会经常出现merge错误
2. 如果修改了同一个文档，只要不是修改的同一行，就不会报错。所以模块化的分工也是必要的



### 创建分支与分支的效果

创建分支的指令如下：

```shell
git branch B1 # 创建名为B1的分支
git branch -v # 查看所有分支信息
git checkout B1 # 切换到B1分支
```

